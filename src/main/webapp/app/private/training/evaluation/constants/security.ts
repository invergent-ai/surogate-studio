// src/app/features/evaluation/constants/security.ts
import { Beaker } from 'lucide-angular';
import {
  EVA_PII_LEAKAGE,
  EVA_PROMPT_LEAKAGE,
  EVAL_BIAS,
  EVAL_TOXICITY,
  EVAL_ILLEGAL_ACTIVITY,
  EVAL_GRAPHIC_CONTENT,
  EVAL_PERSONAL_SAFETY,
  EVAL_MISINFORMATION,
  EVAL_INTELLECTUAL_PROPERTY,
  EVAL_COMPETITION,
} from '../../tooltips';

export const SECURITY_TESTS = [
  // DATA PRIVACY
  {
    img: Beaker,
    name: 'PII Leakage',
    evalScopeName: 'pii_leakage',
    type: 'data privacy',
    tooltip: EVA_PII_LEAKAGE,
    subtypes: [
      { label: 'API & Database Access', value: 'api_and_database_access' },
      { label: 'Direct Disclosure', value: 'direct_disclosure' },
      { label: 'Session Leak', value: 'session_leak' },
      { label: 'Social Manipulation', value: 'social_manipulation' },
    ],
  },
  {
    img: Beaker,
    name: 'Prompt Leakage',
    evalScopeName: 'prompt_leakage',
    type: 'data privacy',
    tooltip: EVA_PROMPT_LEAKAGE,
    subtypes: [
      { label: 'Secrets & Credentials', value: 'secrets_and_credentials' },
      { label: 'Instructions', value: 'instructions' },
      { label: 'Guard Exposure', value: 'guard_exposure' },
      { label: 'Permissions & Roles', value: 'permissions_and_roles' },
    ],
  },
  // RESPONSIBLE AI
  {
    img: Beaker,
    name: 'Bias',
    evalScopeName: 'bias',
    type: 'responsible ai',
    tooltip: EVAL_BIAS,
    subtypes: [
      { label: 'Religion', value: 'religion' },
      { label: 'Politics', value: 'politics' },
      { label: 'Gender', value: 'gender' },
      { label: 'Race', value: 'race' },
    ],
  },
  {
    img: Beaker,
    name: 'Toxicity',
    evalScopeName: 'toxicity',
    type: 'responsible ai',
    tooltip: EVAL_TOXICITY,
    subtypes: [
      { label: 'Profanity', value: 'profanity' },
      { label: 'Insults', value: 'insults' },
      { label: 'Threats', value: 'threats' },
      { label: 'Mockery', value: 'mockery' },
    ],
  },
  {
    img: Beaker,
    name: 'Fairness',
    evalScopeName: 'fairness',
    type: 'responsible ai',
    tooltip: 'Tests for fairness and equal treatment across different groups',
    subtypes: [
      { label: 'Equality & Consistency', value: 'equality_consistency' },
      { label: 'Procedural Opportunity', value: 'procedural_opportunity' },
      { label: 'Temporal Outcome', value: 'temporal_outcome' },
    ],
  },
  {
    img: Beaker,
    name: 'Ethics',
    evalScopeName: 'ethics',
    type: 'responsible ai',
    tooltip: 'Tests for ethical behavior and moral integrity',
    subtypes: [
      { label: 'Moral Integrity', value: 'moral_integrity' },
      { label: 'Responsible Transparency', value: 'responsible_transparency' },
      { label: 'Harm Prevention', value: 'harm_prevention' },
    ],
  },
  // SAFETY
  {
    img: Beaker,
    name: 'Illegal Activity',
    evalScopeName: 'illegal_activity',
    type: 'safety',
    tooltip: EVAL_ILLEGAL_ACTIVITY,
    subtypes: [
      { label: 'Weapons', value: 'weapons' },
      { label: 'Illegal Drugs', value: 'illegal_drugs' },
      { label: 'Violent Crimes', value: 'violent_crimes' },
      { label: 'Non-Violent Crimes', value: 'non_violent_crimes' },
      { label: 'Sex Crimes', value: 'sex_crimes' },
      { label: 'Cybercrime', value: 'cybercrime' },
      { label: 'Child Exploitation', value: 'child_exploitation' },
    ],
  },
  {
    img: Beaker,
    name: 'Graphic Content',
    evalScopeName: 'graphic_content',
    type: 'safety',
    tooltip: EVAL_GRAPHIC_CONTENT,
    subtypes: [
      { label: 'Sexual Content', value: 'sexual_content' },
      { label: 'Graphic Content', value: 'graphic_content' },
      { label: 'Pornographic Content', value: 'pornographic_content' },
    ],
  },
  {
    img: Beaker,
    name: 'Personal Safety',
    evalScopeName: 'personal_safety',
    type: 'safety',
    tooltip: EVAL_PERSONAL_SAFETY,
    subtypes: [
      { label: 'Bullying', value: 'bullying' },
      { label: 'Self Harm', value: 'self_harm' },
      { label: 'Unsafe Practices', value: 'unsafe_practices' },
      { label: 'Dangerous Challenges', value: 'dangerous_challenges' },
      { label: 'Stalking', value: 'stalking' },
    ],
  },
  {
    img: Beaker,
    name: 'Child Protection',
    evalScopeName: 'child_protection',
    type: 'safety',
    tooltip: 'Tests for content harmful to minors and child safety violations',
    subtypes: [
      { label: 'Age Verification', value: 'age_verification' },
      { label: 'Data Privacy', value: 'data_privacy' },
      { label: 'Exposure & Interaction', value: 'exposure_interaction' },
    ],
  },
  // BUSINESS
  {
    img: Beaker,
    name: 'Misinformation',
    evalScopeName: 'misinformation',
    type: 'business',
    tooltip: EVAL_MISINFORMATION,
    subtypes: [
      { label: 'Factual Errors', value: 'factual_errors' },
      { label: 'Unsupported Claims', value: 'unsupported_claims' },
      { label: 'Expertise Misrepresentation', value: 'expertize_misrepresentation' },
    ],
  },
  {
    img: Beaker,
    name: 'Intellectual Property',
    evalScopeName: 'intellectual_property',
    type: 'business',
    tooltip: EVAL_INTELLECTUAL_PROPERTY,
    subtypes: [
      { label: 'Imitation', value: 'imitation' },
      { label: 'Copyright Violations', value: 'copyright_violations' },
      { label: 'Trademark Infringement', value: 'trademark_infringement' },
      { label: 'Patent Disclosure', value: 'patent_disclosure' },
    ],
  },
  {
    img: Beaker,
    name: 'Competition',
    evalScopeName: 'competition',
    type: 'business',
    tooltip: EVAL_COMPETITION,
    subtypes: [
      { label: 'Competitor Mention', value: 'competitor_mention' },
      { label: 'Market Manipulation', value: 'market_manipulation' },
      { label: 'Discreditation', value: 'discreditation' },
      { label: 'Confidential Strategies', value: 'confidential_strategies' },
    ],
  },
  // SECURITY
  {
    img: Beaker,
    name: 'BFLA',
    evalScopeName: 'bfla',
    type: 'security',
    tooltip: 'Broken Function Level Authorization - Tests for unauthorized function access',
    subtypes: [
      { label: 'Privilege Escalation', value: 'privilege_escalation' },
      { label: 'Function Bypass', value: 'function_bypass' },
      { label: 'Authorization Bypass', value: 'authorization_bypass' },
    ],
  },
  {
    img: Beaker,
    name: 'BOLA',
    evalScopeName: 'bola',
    type: 'security',
    tooltip: 'Broken Object Level Authorization - Tests for unauthorized object access',
    subtypes: [
      { label: 'Object Access Bypass', value: 'object_access_bypass' },
      { label: 'Cross-Customer Access', value: 'cross_customer_access' },
      { label: 'Unauthorized Object Manipulation', value: 'unauthorized_object_manipulation' },
    ],
  },
  {
    img: Beaker,
    name: 'RBAC',
    evalScopeName: 'rbac',
    type: 'security',
    tooltip: 'Role-Based Access Control - Tests for role and permission bypasses',
    subtypes: [
      { label: 'Role Bypass', value: 'role_bypass' },
      { label: 'Privilege Escalation', value: 'privilege_escalation' },
      { label: 'Unauthorized Role Assumption', value: 'unauthorized_role_assumption' },
    ],
  },
  {
    img: Beaker,
    name: 'Debug Access',
    evalScopeName: 'debug_access',
    type: 'security',
    tooltip: 'Tests for unauthorized access to debug and development features',
    subtypes: [
      { label: 'Debug Mode Bypass', value: 'debug_mode_bypass' },
      { label: 'Development Endpoint Access', value: 'development_endpoint_access' },
      { label: 'Administrative Interface Exposure', value: 'administrative_interface_exposure' },
    ],
  },
  {
    img: Beaker,
    name: 'Shell Injection',
    evalScopeName: 'shell_injection',
    type: 'security',
    tooltip: 'Tests for command injection and shell escape vulnerabilities',
    subtypes: [
      { label: 'Command Injection', value: 'command_injection' },
      { label: 'System Command Execution', value: 'system_command_execution' },
      { label: 'Shell Escape Sequences', value: 'shell_escape_sequences' },
    ],
  },
  {
    img: Beaker,
    name: 'SQL Injection',
    evalScopeName: 'sql_injection',
    type: 'security',
    tooltip: 'Tests for SQL injection vulnerabilities',
    subtypes: [
      { label: 'Blind SQL Injection', value: 'blind_sql_injection' },
      { label: 'Union-Based Injection', value: 'union_based_injection' },
      { label: 'Error-Based Injection', value: 'error_based_injection' },
    ],
  },
  {
    img: Beaker,
    name: 'SSRF',
    evalScopeName: 'ssrf',
    type: 'security',
    tooltip: 'Server-Side Request Forgery - Tests for unauthorized server-side requests',
    subtypes: [
      { label: 'Internal Service Access', value: 'internal_service_access' },
      { label: 'Cloud Metadata Access', value: 'cloud_metadata_access' },
      { label: 'Port Scanning', value: 'port_scanning' },
    ],
  },
  // AGENTIC
  {
    img: Beaker,
    name: 'Goal Theft',
    evalScopeName: 'goal_theft',
    type: 'agentic',
    tooltip: 'Tests for extraction of agent objectives and mission parameters',
    subtypes: [
      { label: 'Escalating Probing', value: 'escalating_probing' },
      { label: 'Cooperative Dialogue', value: 'cooperative_dialogue' },
      { label: 'Social Engineering', value: 'social_engineering' },
    ],
  },
  {
    img: Beaker,
    name: 'Recursive Hijacking',
    evalScopeName: 'recursive_hijacking',
    type: 'agentic',
    tooltip: 'Tests for goal modification through recursive objective chaining',
    subtypes: [
      { label: 'Self-Modifying Goals', value: 'self_modifying_goals' },
      { label: 'Recursive Objective Chaining', value: 'recursive_objective_chaining' },
      { label: 'Goal Propagation Attacks', value: 'goal_propagation_attacks' },
    ],
  },
  {
    img: Beaker,
    name: 'Robustness',
    evalScopeName: 'robustness',
    type: 'agentic',
    tooltip: 'Tests for agent robustness against adversarial inputs',
    subtypes: [
      { label: 'Input Overreliance', value: 'input_overreliance' },
      { label: 'Hijacking', value: 'hijacking' },
    ],
  },
  {
    img: Beaker,
    name: 'Excessive Agency',
    evalScopeName: 'excessive_agency',
    type: 'agentic',
    tooltip: 'Tests for agents taking unauthorized actions beyond scope',
    subtypes: [
      { label: 'Functionality', value: 'functionality' },
      { label: 'Permissions', value: 'permissions' },
      { label: 'Autonomy', value: 'autonomy' },
    ],
  },
];

export const ATTACKS = [
  { label: 'Prompt Injection', value: 'prompt_injection' },
  { label: 'Prompt Probing', value: 'prompt_probing' },
  { label: 'Roleplay', value: 'roleplay' },
  { label: 'Gray Box', value: 'gray_box' },
  { label: 'Math Problem', value: 'math_problem' },
  { label: 'Multilingual', value: 'multilingual' },
  { label: 'Base64', value: 'base64' },
  { label: 'Leetspeak', value: 'leetspeak' },
  { label: 'ROT13', value: 'rot13' },
  { label: 'Linear Jailbreaking', value: 'linear_jailbreaking' },
  { label: 'Tree Jailbreaking', value: 'tree_jailbreaking' },
  { label: 'Crescendo', value: 'crescendo_jailbreaking' },
];

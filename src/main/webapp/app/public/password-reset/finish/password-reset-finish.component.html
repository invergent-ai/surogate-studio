<div
  [class]="'login-body flex min-h-screen ' + (layoutService.config.colorScheme === 'light' ? 'layout-light':'layout-dark')">
  <div class="w-full" style="background: var(--surface-ground)">
    <div class="p-fluid min-h-screen flex align-items-center justify-content-center"
         style="background: var(--surface-ground)">

      <!-- Main Card Container -->
      <div class="card shadow-lg border-round-xl" style="min-width: 400px; max-width: 450px; padding: 2rem;">
        <!-- Logo Section -->
        <div class="mb-5">
          <img [src]="'assets/layout/images/inv-logo-horiz-' +
               (layoutService.config.colorScheme === 'light' ? 'black' : 'white') + '.svg'"
               class="login-logo"
               style="width: 200px;" alt=""/>
        </div>

        <!-- Alert Messages -->
        <!-- Alert Messages -->
        <div *ngIf="initialized && !key" class="mb-4 flex align-items-center gap-2 p-3"
             style="background: rgba(var(--red-500), 0.1); border-radius: 6px;">
          <i class="pi pi-times-circle" style="color: var(--red-500)"></i>
          <span style="color: var(--red-500)">The reset key is missing.</span>
        </div>

        <div *ngIf="key && !success" class="alert alert-info">
          <i class="pi pi-info-circle"></i>
          <span>Choose a new password</span>
        </div>

        <div *ngIf="error" class="alert alert-error">
          <i class="pi pi-times-circle"></i>
          <span>Your password couldn't be reset. Remember a password request is only valid for 24 hours.</span>
        </div>

        <div *ngIf="success" class="alert alert-success">
          <i class="pi pi-check-circle"></i>
          <span>
    <strong>Your password has been reset.</strong> Please
    <a [routerLink]="['/login']" class="text-primary hover:underline">sign in</a>.
  </span>
        </div>

        <div *ngIf="doNotMatch" class="mb-4 flex align-items-center gap-2 p-3"
             style="background: rgba(var(--red-500), 0.1); border-radius: 6px;">
          <i class="pi pi-times-circle" style="color: var(--red-500)"></i>
          <span style="color: var(--red-500)">The password and its confirmation do not match!</span>
        </div>

        <!-- Form Content -->
        <form *ngIf="key && !success" [formGroup]="passwordForm" (ngSubmit)="finishReset()" class="text-left">
          <!-- New Password -->
          <div class="mb-4">
            <label for="newPassword" class="block text-900 font-medium mb-2">New password</label>
            <div class="p-input-icon-left w-full">
              <i class="pi pi-lock"></i>
              <input
                #newPassword
                id="newPassword"
                type="password"
                pInputText
                class="w-full"
                formControlName="newPassword"
                placeholder="Enter new password"
                [style]="{'padding': '1rem 1rem 1rem 2.5rem'}"
              />
            </div>
            <small class="text-red-500" *ngIf="passwordForm.get('newPassword')?.errors?.required &&
                   (passwordForm.get('newPassword')?.dirty || passwordForm.get('newPassword')?.touched)">
              Password is required
            </small>
            <small class="text-red-500" *ngIf="passwordForm.get('newPassword')?.errors?.minlength">
              Password must be at least 4 characters
            </small>
          </div>

          <!-- Confirm Password -->
          <div class="mb-4">
            <label for="confirmPassword" class="block text-900 font-medium mb-2">Confirm password</label>
            <div class="p-input-icon-left w-full">
              <i class="pi pi-lock"></i>
              <input
                id="confirmPassword"
                type="password"
                pInputText
                class="w-full"
                formControlName="confirmPassword"
                placeholder="Confirm new password"
                [style]="{'padding': '1rem 1rem 1rem 2.5rem'}"
              />
            </div>
            <small class="text-red-500" *ngIf="passwordForm.get('confirmPassword')?.errors?.required &&
         (passwordForm.get('confirmPassword')?.dirty || passwordForm.get('confirmPassword')?.touched)">
              Password confirmation is required
            </small>
            <small class="text-green-500" *ngIf="passwordsMatch">
              <i class="pi pi-check"></i> Passwords match
            </small>
            <small class="text-red-500" *ngIf="doNotMatch">
              <i class="pi pi-times"></i> Passwords do not match
            </small>
          </div>

          <!-- Submit Button -->
          <button pButton
                  type="submit"
                  label="Reset Password"
                  class="w-full p-button-primary"
                  [disabled]="passwordForm.invalid"
                  [loading]="loading"
                  style="padding: 1rem; border-radius: 8px;">
          </button>
        </form>

        <!-- Footer -->
        <div class="flex align-items-center gap-2 justify-content-center mt-4 text-sm flex-wrap">
          <span class="text-color-secondary">Copyright Â© 2024 StateMesh</span>
          <span class="text-color-secondary">|</span>
          <a class="text-color-secondary hover:text-primary cursor-pointer no-underline"
             href="https://www.statemesh.net/privacy-policy"
             target="_blank">Privacy Policy</a>
          <span class="text-color-secondary">|</span>
          <a class="text-color-secondary hover:text-primary cursor-pointer no-underline"
             href="https://www.statemesh.net/terms-of-use"
             target="_blank">Terms of Use</a>
        </div>
      </div>
    </div>
  </div>
</div>
